# Переменные окружения
`DB_USERNAME` - Админ-пользователь  
`DB_PASSWORD` - Пароль админ-пользователя  
`DB_NAME` - Название базы данных

###  Запуск Mongo в контейнере
Дальнейшие команды выполняются в одной директории с `docker-compose.yaml`.
Создать docker том при помощи команды `docker volume create passage-products`.  
Запустить Mongo в контейнере через: `docker-compose -f docker-compose.yaml up -d`.  
Убедиться, что по адресу `127.0.0.1:8081` в браузере открывается админ-панель Mongo.  

### Запуск парсера  
Установить необходимые зависимости:
- `cd products-parser`
- `python3 -m venv env`
- `source env/bin/activate`
- `pip install -r requirements.txt`

Дальнейшие команды выполняются в директории `src/`. 
 
Перед запуском парсера в `main.py` отредактировать константу `JSON_PATH` и указать путь к целевой json-выгрузке. 
Запустить парсер при помощи команды `python3 main.py`.  
Результатом парсинга будет наполненная база данных Mongo удачно обработанными товарами. На странице `127.0.0.1:8081` появится новая БД в списке с именем переменной окружения `DB_NAME`, в ней - коллекция `products`.  

*Примечание: в файле* `src/json_parser.py` *присутствует константа* `SEQUENTIAL: bool`. *При* `SEQUENTIAL=True` *парсер будет искать дубликаты товаров в соседних с целевым товаром объектах (оптимизирует время парсинга ~ в 20 раз), при* `SEQUENTIAL: False` *парсер будет искать дубликаты в промежутке от целевого товара до конца документа. Подразумевается использовать* `SEQUENTIAL=True` *когда известно, что документ отсортирован и дубликаты стоят рядом друг с другом.*   

### Запуск тестов
В корневой директории проекта выполнить команду: `pytest tests/`
